{"coveredLines":11,"missedLines":48,"coveragePercentage":18.64,"sourceFiles":[{"name":"main.bal","moduleName":"RESTModule","coveredLines":[9,11,13,15,16,56,57,58,78,79,80],"missedLines":[19,20,21,22,24,25,27,28,32,36,38,39,40,42,46,47,50,51,52,54,61,62,63,65,66,69,70,72,73,76,83,85,86,87,89,90,92,93,96,97,99,102,103,106,107,108,110,111],"coveragePercentage":18.64,"sourceCode":"import ballerina/log;\nimport ballerina/http;\n\n\nlistener http:Listener httpListener \u003d new (9090);\n\nmap\u003cjson\u003e customerDataMap \u003d {};\n\n@http:ServiceConfig {basePath: \"/\"}\n\nservice customerDataManagement on httpListener{\n\n    @http:ResourceConfig {\n\n        methods: [\"POST\"],\n        path: \"/customer\"\n    }\n\n    resource function addCustomer (http:Caller caller, http:Request req){\n        http:Response response \u003d new;\n        var customerDetailsReq \u003d req.getJsonPayload();\n        log:printInfo(customerDetailsReq.toString());\n\n        if(customerDetailsReq is json){\n            json|error customerIdReq \u003d customerDetailsReq.Customer.Id;\n            \n            if customerIdReq is error{\n                log:printError(\"Unable to add customer\");\n            }\n            else{\n                \n                string customerId \u003d customerIdReq.toString();\n\n                //log:printDebug(\"customerId : \" + customerId);\n\n                customerDataMap[customerId] \u003d \u003c@untainted\u003e customerDetailsReq;\n\n                json payload \u003d { status: \"Customer Added.\", customerId: customerId };\n                response.setJsonPayload(\u003c@untainted\u003epayload);\n                response.statusCode \u003d 201;\n\n                response.setHeader(\"Location\",\"http://localhost:9090/customerDataManagement/\" + customerId);\n            }\n        }\n        else {\n            response.statusCode \u003d 400;\n            response.setPayload(\"Invalid payload received\");\n        }\n\n        var result \u003d caller -\u003e respond(response);\n        if result is error {\n            log:printError(\"Error sending response\", err \u003d result);\n        }\n    }\n\n    @http:ResourceConfig {\n        methods: [\"GET\"],\n        path: \"/customer/{customerId}\"\n    }\n\n    resource function getCustomerDetails (http:Caller caller, http:Request req, string customerId){\n        json payload \u003d customerDataMap[customerId];\n        http: Response response \u003d new;\n\n        if(payload \u003d\u003d null){\n            payload \u003d \"Customer : \" + customerId + \" cannot be found !\";\n        }\n\n        response.setJsonPayload(\u003c@untainted\u003e payload);\n        var result \u003d caller -\u003e respond(response);\n\n        if result is error{\n            log:printError(\"Error sending response\",err\u003dresult);\n        }\n\n    }\n\n    @http:ResourceConfig {\n            methods: [\"PUT\"],\n            path: \"/customer/{customerId}\"\n        }\n\n    resource function updateCustomerDetails(http:Caller caller, http:Request req, string customerId) {\n\n        http:Response response \u003d new;\n        var customerDetailsReq \u003d req.getJsonPayload();\n        log:printInfo(customerDetailsReq.toString());\n\n        if(customerDetailsReq is json){\n            json existingCustomer \u003d customerDataMap[customerId];\n            \n            if (existingCustomer \u003d\u003d null){\n                existingCustomer \u003d \"Customer : \" + customerId + \" cannot be found !\";\n            }\n            else{\n                customerDataMap[customerId] \u003d \u003c@untainted\u003e customerDetailsReq;\n                existingCustomer \u003d customerDetailsReq;\n            }\n            response.setJsonPayload(\u003c@untainted\u003e existingCustomer);\n        }\n        else {\n            response.statusCode \u003d 400;\n            response.setPayload(\"Invalid payload received\");\n        }\n\n        var result \u003d caller -\u003e respond(response);\n        if result is error {\n            log:printError(\"Error sending response\", err \u003d result);\n        }\n    }\n}\n"}]}